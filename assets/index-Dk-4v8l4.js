var ot=Object.defineProperty;var rt=(v,t,e)=>t in v?ot(v,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):v[t]=e;var L=(v,t,e)=>rt(v,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();var q={exports:{}},Z;function ht(){return Z||(Z=1,function(v){(function(){var t=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],e=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ",["ㅗ","ㅏ"],["ㅗ","ㅐ"],["ㅗ","ㅣ"],"ㅛ","ㅜ",["ㅜ","ㅓ"],["ㅜ","ㅔ"],["ㅜ","ㅣ"],"ㅠ","ㅡ",["ㅡ","ㅣ"],"ㅣ"],i=["","ㄱ","ㄲ",["ㄱ","ㅅ"],"ㄴ",["ㄴ","ㅈ"],["ㄴ","ㅎ"],"ㄷ","ㄹ",["ㄹ","ㄱ"],["ㄹ","ㅁ"],["ㄹ","ㅂ"],["ㄹ","ㅅ"],["ㄹ","ㅌ"],["ㄹ","ㅍ"],["ㄹ","ㅎ"],"ㅁ","ㅂ",["ㅂ","ㅅ"],"ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],n=44032,o=["ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄸ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅃ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],h=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],a=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"],M=["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],B=[["ㄱ","ㅅ","ㄳ"],["ㄴ","ㅈ","ㄵ"],["ㄴ","ㅎ","ㄶ"],["ㄹ","ㄱ","ㄺ"],["ㄹ","ㅁ","ㄻ"],["ㄹ","ㅂ","ㄼ"],["ㄹ","ㅅ","ㄽ"],["ㄹ","ㅌ","ㄾ"],["ㄹ","ㅍ","ㄿ"],["ㄹ","ㅎ","ㅀ"],["ㅂ","ㅅ","ㅄ"]],R=[["ㅗ","ㅏ","ㅘ"],["ㅗ","ㅐ","ㅙ"],["ㅗ","ㅣ","ㅚ"],["ㅜ","ㅓ","ㅝ"],["ㅜ","ㅔ","ㅞ"],["ㅜ","ㅣ","ㅟ"],["ㅡ","ㅣ","ㅢ"]],c,m,d,T,k,j;function K(s){for(var r=s.length,S={0:0},l=0;l<r;l++)s[l]&&(S[s[l].charCodeAt(0)]=l);return S}c=K(o),m=K(h),d=K(a),T=K(M);function G(s){for(var r=s.length,S={},l,u,g=0;g<r;g++)l=s[g][0].charCodeAt(0),u=s[g][1].charCodeAt(0),typeof S[l]>"u"&&(S[l]={}),S[l][u]=s[g][2].charCodeAt(0);return S}k=G(B),j=G(R);function W(s){return typeof c[s]<"u"}function N(s){return typeof m[s]<"u"}function O(s){return typeof d[s]<"u"}function X(s){return typeof T[s]<"u"}function _(s){return 44032<=s&&s<=55203}function U(s,r){return j[s]&&j[s][r]?j[s][r]:!1}function J(s,r){return k[s]&&k[s][r]?k[s][r]:!1}var P=function(s,r){if(s===null)throw new Error("Arguments cannot be null");typeof s=="object"&&(s=s.join(""));for(var S=[],l=s.length,u,g,A,C,x,b=0;b<l;b++){var f=[];C=s.charCodeAt(b),_(C)?(C-=n,A=C%28,g=(C-A)/28%21,u=parseInt((C-A)/28/21),f.push(t[u]),typeof e[g]=="object"?f=f.concat(e[g]):f.push(e[g]),A>0&&(typeof i[A]=="object"?f=f.concat(i[A]):f.push(i[A]))):W(C)?(N(C)?x=t[m[C]]:x=i[T[C]],typeof x=="string"?f.push(x):f=f.concat(x)):O(C)?(x=e[d[C]],typeof x=="string"?f.push(x):f=f.concat(x)):f.push(s.charAt(b)),r?S.push(f):S=S.concat(f)}return S},V=function(s){return typeof s!="string"?"":(s=P(s),s.join(""))},Y=function(s){typeof s=="string"&&(s=P(s));var r=[],S=s.length,l,u=0,g=-1,A,C=!1;function x(f){var p,y,$,H=0,z,F="";if(C=!1,!(g+1>f))for(var w=1;;w++){if(w===1){if(p=s[g+w].charCodeAt(0),O(p))if(g+w+1<=f&&O(y=s[g+w+1].charCodeAt(0))){r.push(String.fromCharCode(U(p,y))),g=f;return}else{r.push(s[g+w]),g=f;return}else if(!N(p)){r.push(s[g+w]),g=f;return}F=s[g+w]}else if(w===2)if(y=s[g+w].charCodeAt(0),N(y)){p=J(p,y),F=String.fromCharCode(p),r.push(F),g=f;return}else F=String.fromCharCode((m[p]*21+d[y])*28+n);else w===3?($=s[g+w].charCodeAt(0),U(y,$)?y=U(y,$):H=$,F=String.fromCharCode((m[p]*21+d[y])*28+T[H]+n)):w===4?(z=s[g+w].charCodeAt(0),J(H,z)?H=J(H,z):H=z,F=String.fromCharCode((m[p]*21+d[y])*28+T[H]+n)):w===5&&(z=s[g+w].charCodeAt(0),H=J(H,z),F=String.fromCharCode((m[p]*21+d[y])*28+T[H]+n));if(g+w>=f){r.push(F),g=f;return}}}for(var b=0;b<S;b++){if(l=s[b].charCodeAt(0),!N(l)&&!O(l)&&!X(l)){x(b-1),x(b),u=0;continue}u===0?N(l)?u=1:O(l)&&(u=4):u==1?O(l)?u=2:J(A,l)?u=5:x(b-1):u==2?X(l)?u=3:O(l)?U(A,l)||(x(b-1),u=4):(x(b-1),u=1):u==3?X(l)?!C&&J(A,l)?C=!0:(x(b-1),u=1):N(l)?(x(b-1),u=1):O(l)&&(x(b-2),u=2):u==4?O(l)?U(A,l)?(x(b),u=0):x(b-1):(x(b-1),u=1):u==5&&(O(l)?(x(b-2),u=2):(x(b-1),u=1)),A=l}return x(b-1),r.join("")},tt=function(s,r){var S=P(s).join(""),l=P(r).join("");return S.indexOf(l)},et=function(s,r){var S=P(s).join(""),l=P(r).join(""),u=P(s,!0),g=new RegExp(l,"gi"),A=[],C;if(!r.length)return[];for(;C=g.exec(S);)A.push(C.index);function x(f){for(var p=0,y=0;p<u.length;++p)if(y+=u[p].length,f<y)return p}function b(f){for(var p=0,y=0;p<u.length;++p)if(y+=u[p].length,f+l.length<=y)return p}return A.map(function(f){return[x(f),b(f)]})};function Q(s){this.string=s,this.disassembled=P(s).join("")}Q.prototype.search=function(s){return P(s).join("").indexOf(this.disassembled)};var st=function(s){typeof s=="object"&&(s=s.join(""));var r=s.charCodeAt(s.length-1);if(_(r)){r-=n;var S=r%28;if(S>0)return!0}else if(W(r))return!0;return!1},it=function(s,r){return P(s).pop()===r},nt={disassemble:P,d:P,disassembleToString:V,ds:V,assemble:Y,a:Y,search:tt,rangeSearch:et,Searcher:Q,endsWithConsonant:st,endsWith:it,isHangul:function(s){return typeof s=="string"&&(s=s.charCodeAt(0)),_(s)},isComplete:function(s){return typeof s=="string"&&(s=s.charCodeAt(0)),_(s)},isConsonant:function(s){return typeof s=="string"&&(s=s.charCodeAt(0)),W(s)},isVowel:function(s){return typeof s=="string"&&(s=s.charCodeAt(0)),O(s)},isCho:function(s){return typeof s=="string"&&(s=s.charCodeAt(0)),N(s)},isJong:function(s){return typeof s=="string"&&(s=s.charCodeAt(0)),X(s)},isHangulAll:function(s){if(typeof s!="string")return!1;for(var r=0;r<s.length;r++)if(!_(s.charCodeAt(r)))return!1;return!0},isCompleteAll:function(s){if(typeof s!="string")return!1;for(var r=0;r<s.length;r++)if(!_(s.charCodeAt(r)))return!1;return!0},isConsonantAll:function(s){if(typeof s!="string")return!1;for(var r=0;r<s.length;r++)if(!W(s.charCodeAt(r)))return!1;return!0},isVowelAll:function(s){if(typeof s!="string")return!1;for(var r=0;r<s.length;r++)if(!O(s.charCodeAt(r)))return!1;return!0},isChoAll:function(s){if(typeof s!="string")return!1;for(var r=0;r<s.length;r++)if(!N(s.charCodeAt(r)))return!1;return!0},isJongAll:function(s){if(typeof s!="string")return!1;for(var r=0;r<s.length;r++)if(!X(s.charCodeAt(r)))return!1;return!0}};v.exports=nt})()}(q)),q.exports}var D=ht();const E=class E{constructor(t,e){L(this,"canvas");L(this,"context");L(this,"value");L(this,"selection");L(this,"isFocused");L(this,"selectionPos");L(this,"blinkTimer");L(this,"maxLength");L(this,"assemblePos");L(this,"startPos");L(this,"wasOver");L(this,"settings");this.canvas=e,this.context=e.getContext("2d"),this.settings=Object.assign({},E.defaultSettings,t),this.value=this.settings.defaultValue,this.selection=[0,0],this.isFocused=!1,this.blinkTimer=0,this.maxLength=this.settings.maxLength,this.resetSelectionPos(),this.resetAssembleMode(),this.startPos=0,this.wasOver=!1,document.addEventListener("keydown",this.onKeyDown.bind(this)),this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this),!0),this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this),!0),document.addEventListener("mouseup",this.onMouseUp.bind(this),!0),this.canvas.addEventListener("dblclick",this.onDoubleClick.bind(this),!0),this.canvas.addEventListener("copy",async i=>this.onCopy.call(this,i)),this.canvas.addEventListener("paste",async i=>this.onPaste.call(this,i)),this.canvas.addEventListener("cut",async i=>this.onCut.call(this,i))}draw(){this.context.font=`${this.settings.fontSize}px ${this.settings.font}`,this.context.textAlign="left",this.context.textBaseline="middle";const t=this.getStartX(),e=this.getStartY(),i=this.area(),n=Math.round(e+Math.round(this.settings.fontSize/2)+1);if(this.context.save(),this.context.beginPath(),this.context.rect(i.x,i.y,i.w+1,i.h+1),this.context.clip(),this.disabled&&(this.context.fillStyle=this.settings.disabledColor,this.context.fillRect(this.settings.bounds.x-this.settings.padding.left,this.settings.bounds.y-this.settings.padding.top,i.w,i.h)),this.isFocused){if(this.isSelected()){const c=this.measureText(this.getSubText(0,Math.min(this.selection[0],this.selection[1]))),m=this.measureText(this.getSelectionText());this.context.fillStyle=this.settings.selectionColor,this.context.fillRect(c+t,e-1,m,this.settings.fontSize+3)}else if(this.cursorBlink()){const c=this.measureText(this.getSubText(0,this.selection[0]));this.context.fillStyle=this.settings.fontColor,this.context.fillRect(c+t,e,1,this.settings.fontSize)}}const[o,h]=this.getSelectionOutside(),a=this.getSelectionText(),M=this.getDrawText(o),B=this.getDrawText(a),R=this.getDrawText(h);this.context.fillStyle=this.disabled?this.settings.disabledFontColor:this.settings.fontColor,this.context.fillText(M,t,n),this.context.fillStyle=this.disabled?this.settings.disabledFontColor:this.settings.selectionFontColor,this.context.fillText(B,t+this.measureText(o),n),this.context.fillStyle=this.disabled?this.settings.disabledFontColor:this.settings.fontColor,this.context.fillText(R,t+this.measureText(o+a),n),this.isEmpty()&&(this.context.fillStyle=this.settings.placeHolderColor,this.context.fillText(this.settings.placeHolder,t,n)),this.isFocused&&this.isAssembleMode()&&this.drawUnderline(),this.drawRect(i.x,i.y,i.w,i.h),this.context.restore()}update(t){this.blinkTimer+=t}isSelected(){return this.selection[0]!==this.selection[1]}isEmpty(){return this.getLength()===0}getLength(){return this.value.length}getMaxLength(){return this.settings.maxLength}set text(t){this.value=t}get text(){return this.value}get focus(){return this.isFocused}set focus(t){t&&!this.disabled?(this.isFocused=!0,this.blinkTimer=this.settings.caretBlinkRate,this.settings.focusCallback(!0)):(this.onStartOfSelection(),this.resetAssembleMode(),this.resetSelectionPos(),this.isFocused=!1,this.settings.focusCallback(!1))}get disabled(){return this.settings.disabled}set disabled(t){this.settings.disabled=t,this.focus=!1}get type(){return this.settings.type}set type(t){this.settings.type=t,this.resetAssembleMode(),this.onCancelOfSelectionEnd()}moveSelection(t){this.setSelection(t,t)}setSelection(t,e){t=this.clamp(t,0,this.getLength()),e=this.clamp(e,0,this.getLength()),this.selection[0]=t,this.selection[1]=e,this.blinkTimer=this.settings.caretBlinkRate}at(t){return this.value[t]}getDrawText(t){return this.type==="password"?this.settings.passwordChar.repeat(t.length):t}drawUnderline(){const t=this.getStartX(),e=this.getStartY()+this.settings.fontSize-2;this.context.fillStyle=this.settings.underlineColor;const i=this.measureText(this.getAssemblePosBefore()),n=this.measureText(this.getAssemblePosChar());this.context.fillRect(i+t,e,n,2)}getStartX(){return this.settings.bounds.x+this.settings.padding.left+this.settings.border.left}getStartY(){return this.settings.bounds.y+this.settings.padding.top+this.settings.border.top}measureText(t){return this.context.font=`${this.settings.fontSize}px ${this.settings.font}`,this.context.textAlign="left",this.context.textBaseline="middle",this.context.measureText(this.getDrawText(t)).width}cursorBlink(){return Math.floor(this.blinkTimer/this.settings.caretBlinkRate)%2}getSelectionText(){return this.getSubText(this.selection[0],this.selection[1])}getSubText(t,e){return this.value.substring(t,e)}extendSelection(t,e){this.setSelection(t,e)}moveRightBoundary(){const t=Math.max(this.selection[0],this.selection[1]);this.moveSelection(t)}moveLeftBoundary(){const t=Math.min(this.selection[0],this.selection[1]);this.moveSelection(t)}extendRightBoundary(){const t=Math.min(this.selection[0],this.selection[1]);this.extendSelection(t,this.getLength())}extendLeftBoundary(){const t=Math.max(this.selection[0],this.selection[1]);this.extendSelection(t,0)}onRight(t){t.preventDefault();const e=t.altKey,i=t.shiftKey,n=t.metaKey,o=t.ctrlKey,h=this.type==="password";if(this.resetAssembleMode(),this.isSelected()){if(i)if(n||o)this.extendRightBoundary();else if(e){const a=h?this.getLength():this.getStopWordRange(this.selection[1])[1];this.extendSelection(this.selection[0],a)}else this.extendSelection(this.selection[0],this.selection[1]+1);else n||o?this.onEndOfSelection():this.moveRightBoundary();return}if(e){const a=h?this.getLength():this.getStopWordRange(this.selection[1])[1];i?this.extendSelection(this.selection[0],a):this.moveSelection(a);return}if(n||o){i?this.extendSelection(this.selection[0],this.getLength()):this.onEndOfSelection();return}i?this.extendSelection(this.selection[0],this.selection[1]+1):this.moveSelection(this.selection[1]+1)}onLeft(t){t.preventDefault();const e=t.altKey,i=t.shiftKey,n=t.metaKey,o=t.ctrlKey,h=this.type==="password";if(this.resetAssembleMode(),this.isSelected()){if(i)if(n||o)this.extendLeftBoundary();else if(e){const a=h?0:this.getStopWordRange(this.selection[1]-1)[0];this.extendSelection(this.selection[0],a)}else this.extendSelection(this.selection[0],this.selection[1]-1);else n||o?this.onStartOfSelection():this.moveLeftBoundary();return}if(e){const a=h?0:this.getStopWordRange(this.selection[0]-1)[0];i?this.extendSelection(this.selection[1],a):this.moveSelection(a);return}if(n||o){i?this.extendSelection(this.selection[1],0):this.onStartOfSelection();return}i?this.extendSelection(this.selection[0],this.selection[1]-1):this.moveSelection(this.selection[1]-1)}onHome(t){if(t.preventDefault(),t.shiftKey){const i=Math.max(this.selection[0],this.selection[1]);this.extendSelection(i,0)}else this.onStartOfSelection()}onEnd(t){if(t.preventDefault(),t.shiftKey){const i=Math.min(this.selection[0],this.selection[1]);this.extendSelection(i,this.getLength())}else this.onEndOfSelection()}onStartOfSelection(){this.moveSelection(0)}onEndOfSelection(){this.moveSelection(this.getLength())}onCancelOfSelectionStart(){this.moveSelection(this.selection[0])}onCancelOfSelectionEnd(){this.moveSelection(this.selection[1])}createClipboardEvent(t){return new ClipboardEvent(t,{bubbles:!0,cancelable:!0,clipboardData:null})}handleMetaInput(t){const e=t.key,i=t.metaKey;return i&&(e==="c"||e==="C"||e==="ㅊ")?(this.canvas.dispatchEvent(this.createClipboardEvent("copy")),!0):i&&(e==="v"||e==="V"||e==="ㅍ")?(this.canvas.dispatchEvent(this.createClipboardEvent("paste")),!0):i&&(e==="x"||e==="X"||e==="ㅌ")?(this.canvas.dispatchEvent(this.createClipboardEvent("cut")),!0):i&&(e==="a"||e==="A"||e==="ㅁ")?(t.preventDefault(),this.selectAllText(),!0):!!(i&&(e==="r"||e==="R"||e==="ㄱ"))}handleTypedText(t){const e=t.key;this.handleMetaInput(t)||e.length>1||this.appendValue(e)}isMaxLengthOverflow(t=""){return this.maxLength===-1?!1:this.getLength()+t.length>this.maxLength}isNumeric(t){return/^-?\d+$/.test(t)}handleMaxLengthOverflow(t){const[e,i]=this.getSelectionOutside(),n=this.settings.maxLength-(e.length+i.length),o=t.substring(0,n);o.length>0&&this.handleNonHangul(e,o,i)}appendValue(t){if(this.type==="number"&&!this.isNumeric(t))return;if(this.isMaxLengthOverflow(t)){this.handleMaxLengthOverflow(t);return}const[e,i]=this.getSelectionOutside();this.isHangul(t)?this.handleHangul(e,t,i):this.handleNonHangul(e,t,i)}handleHangul(t,e,i){if(this.type==="password"){this.assembleHangul(t,this.convertKoreanToEnglish(e),i);return}this.isAssembleMode()?this.assembleHangul(this.getAssemblePosBefore(),D.a(D.d(this.getAssemblePosChar()+e)),i):this.assembleHangul(t,D.a(D.d(e)),i)}assembleHangul(t,e,i){this.text=t+e+i;const n=t.length+e.length;this.moveSelection(n),this.setAssemblePos(n-1)}handleNonHangul(t,e,i){const n=t.length+e.length;this.text=t+e+i,this.moveSelection(n),this.resetAssembleMode()}onRemoveBackward(t){if(t.preventDefault(),t.altKey,this.isSelected()){const[o,h]=this.getSelectionOutside();this.text=o+h,this.moveSelection(o.length);return}this.isAssembleMode()&&this.resetAssembleMode();const[e,i]=this.getSelectionOutside(),n=i.slice(1);this.text=e+n,this.moveSelection(e.length)}onRemoveForward(t){t.preventDefault();const e=t.metaKey;if(t.altKey,this.isSelected()){const[h,a]=this.getSelectionOutside();this.text=h+a,this.moveSelection(h.length);return}if(this.isAssembleMode()&&!e){const h=this.getAssemblePosBefore(),a=D.d(this.getAssemblePosChar()),M=this.getAssemblePosAfter(),B=D.a(a.slice(0,-1));B===""&&this.resetAssembleMode();const R=h+B;this.text=R+M,this.moveSelection(R.length);return}const[i,n]=this.getSelectionOutside(),o=i.slice(0,e?i.length*-1:-1);this.text=o+n,this.moveSelection(o.length)}setAssemblePos(t){this.assemblePos=t}resetAssembleMode(){this.assemblePos=-1}isAssembleMode(){return this.assemblePos!==-1}isHangul(t){const e=t.charCodeAt(0);return e>=4352&&e<=4607||e>=12592&&e<=12687||e>=44032&&e<=55203}isSelectionStart(){return this.selectionPos>=0}resetSelectionPos(){this.selectionPos=-1}textPos(t,e){const i=t-this.area().x;let n=0,o=this.getLength();if(i<this.measureText(this.value)){for(let h=0;h<this.getLength();h++)if(n+=this.measureText(this.at(h)),n>=i){o=h;break}}return o}getMousePos(t){const i=t.target.getBoundingClientRect(),n=t.clientX-i.left,o=t.clientY-i.top;return{x:n,y:o}}onKeyDown(t){if(!this.isFocused)return;switch(t.key){case"Meta":case"Alt":case"Shift":case"Control":case"Tab":case"ArrowUp":case"ArrowDown":break;case"Enter":this.settings.enterCallback(t);break;case"Backspace":this.onRemoveForward(t);break;case"Delete":this.onRemoveBackward(t);break;case"ArrowRight":this.onRight(t);break;case"ArrowLeft":this.onLeft(t);break;case"Escape":this.onCancelOfSelectionEnd();break;case"Home":this.onHome(t);break;case"End":this.onEnd(t);break;case" ":t.preventDefault();default:this.handleTypedText(t);break}}onMouseMove(t){const e=this.getMousePos(t);if(this.contains(e.x,e.y)&&!this.disabled?(this.settings.hoverCallback(!0),this.canvas.style.cursor="text",this.wasOver=!0):(this.settings.hoverCallback(!1),this.wasOver&&(this.canvas.style.cursor="default",this.wasOver=!1)),!this.isFocused||!this.isSelectionStart())return;const i=this.textPos(e.x,e.y),n=Math.min(this.selectionPos,i),o=Math.max(this.selectionPos,i);this.extendSelection(n,o)}onMouseDown(t){t.preventDefault();const e=t.button===0,i=this.getMousePos(t);if(this.resetAssembleMode(),e&&this.contains(i.x,i.y)&&!this.disabled){this.focus=!0;const n=this.textPos(i.x,i.y);if(t.detail===3&&n>=this.selection[0]&&n<=this.selection[1]){this.selectAllText();return}this.moveSelection(n),this.selectionPos=n;return}this.focus=!1}onMouseUp(t){this.isFocused&&this.resetSelectionPos()}onDoubleClick(t){if(!this.isFocused)return;t.preventDefault();const e=t.button===0,i=this.getMousePos(t);if(e&&this.contains(i.x,i.y))if(this.type!=="password"){const n=this.textPos(i.x,i.y),[o,h]=this.getStopWordRange(n);this.extendSelection(o,h)}else this.selectAllText()}async onCopy(t){!this.isFocused||this.type==="password"||this.isEmpty()||await navigator.clipboard.writeText(this.getSelectionText())}async onPaste(t){if(!this.isFocused)return;const e=await navigator.clipboard.readText();if(this.type==="number"&&!this.isNumeric(e))return;if(this.isMaxLengthOverflow(e)){this.handleMaxLengthOverflow(e);return}const[i,n]=this.getSelectionOutside();this.handleNonHangul(i,e,n)}async onCut(t){if(!this.isFocused||this.type==="password"||this.isEmpty())return;await navigator.clipboard.writeText(this.getSelectionText());const[e,i]=this.getSelectionOutside();this.text=e+i,this.moveSelection(e.length)}getStopWordRange(t){const e=this.at(t);if(!e)return[t,t];if(E.DELIMITERS.has(e)){let h=t,a=t+1;for(;h>0&&E.DELIMITERS.has(this.at(h-1))&&this.at(h-1)===e;)h--;for(;a<this.getLength()&&E.DELIMITERS.has(this.at(a))&&this.at(a)===e;)a++;return[h,a]}if(this.isNotCompleteHangul(e)){let h=t,a=t+1;for(;h>0&&this.isNotCompleteHangul(this.at(h-1));)h--;for(;a<this.getLength()&&this.isNotCompleteHangul(this.at(a));)a++;return[h,a]}let i=0,n=this.getLength();const o=this.isHangul(e);for(let h=1;h<this.getLength();h++){const a=t-h,M=t+h;if(a>=0&&i===0&&this.getWordStopCondition(a,o)&&(i=a+1),M<this.getLength()&&n===this.getLength()&&this.getWordStopCondition(M,o)&&(n=M),i!==0&&n!==this.getLength())break}return[i,n]}getWordStopCondition(t,e){const i=this.at(t);return E.DELIMITERS.has(i)||e&&(!this.isHangul(i)||this.isNotCompleteHangul(i))||!e&&this.isHangul(i)}isNotCompleteHangul(t){return this.isHangul(t)&&!D.isComplete(t)}selectAllText(){this.extendSelection(0,this.getLength()),this.resetAssembleMode()}getSelectionOutside(){const t=Math.min(this.selection[0],this.selection[1]),e=Math.max(this.selection[0],this.selection[1]),i=this.getSubText(0,t),n=this.getSubText(e,this.getLength());return[i,n]}getAssemblePosBefore(){return this.getSubText(0,this.assemblePos)}getAssemblePosChar(){return this.getSubText(this.assemblePos,Math.min(this.assemblePos+1,this.getLength()))}getAssemblePosAfter(){return this.getSubText(Math.min(this.assemblePos+1,this.getLength()),this.getLength())}area(){return{x:this.settings.bounds.x-this.settings.padding.left-this.settings.border.left,y:this.settings.bounds.y-this.settings.padding.top-this.settings.border.top,w:this.settings.bounds.w+this.settings.padding.right+this.settings.border.right,h:this.settings.fontSize+4+this.settings.padding.bottom+this.settings.border.bottom}}contains(t,e){const i=this.area();return t>=i.x&&t<=this.settings.bounds.x+i.w&&e>=i.y&&e<=this.settings.bounds.y+i.h}drawRect(t,e,i,n){this.context.beginPath();const o=1;this.context.strokeStyle=this.isFocused?this.settings.focusBoxColor:this.disabled?this.settings.disabledBorderColor:this.settings.boxColor,this.context.lineWidth=this.isFocused?this.settings.focusBorder.left:this.settings.border.left,this.context.moveTo(t+.5,e+o),this.context.lineTo(t+.5,e+n),this.context.lineWidth=this.isFocused?this.settings.focusBorder.right:this.settings.border.right,this.context.moveTo(t+i+.5,e+o),this.context.lineTo(t+i+.5,e+n),this.context.lineWidth=this.isFocused?this.settings.focusBorder.top:this.settings.border.top,this.context.moveTo(t+o,e+.5),this.context.lineTo(t+i,e+.5),this.context.lineWidth=this.isFocused?this.settings.focusBorder.bottom:this.settings.border.bottom,this.context.moveTo(t+o,e+n+.5),this.context.lineTo(t+i,e+n+.5),this.context.stroke()}clamp(t,e,i){return Math.min(Math.max(t,e),i)}convertKoreanToEnglish(t){return E.KOREAN_TO_ENGLISH[t]??t}};L(E,"DELIMITERS",new Set([" ",",",".",";",":","/","[","]","-","\\","?","#","$","%","^","&","*","(",")","!","@","+","=","|","~","`","{","}",'"',"'","<",">"])),L(E,"KOREAN_TO_ENGLISH",{ㅁ:"a",ㄴ:"s",ㅇ:"d",ㄹ:"f",ㅎ:"g",ㅗ:"h",ㅓ:"j",ㅏ:"k",ㅣ:"l",ㅂ:"q",ㅈ:"w",ㄷ:"e",ㄱ:"r",ㅅ:"t",ㅛ:"y",ㅕ:"u",ㅑ:"i",ㅐ:"o",ㅔ:"p",ㅋ:"z",ㅌ:"x",ㅊ:"c",ㅍ:"v",ㅠ:"b",ㅜ:"n",ㅡ:"m",ㅃ:"Q",ㅉ:"W",ㄸ:"E",ㄲ:"R",ㅆ:"T",o:"ㅒ",p:"ㅖ"}),L(E,"defaultSettings",{font:"Apple SD Gothic Neo",fontColor:"#000",selectionFontColor:"#FFF",selectionColor:"#0D0577",boxColor:"#767676",focusBoxColor:"#000",underlineColor:"#000",fontSize:13,maxLength:-1,caretBlinkRate:.5,defaultValue:"",placeHolder:"",placeHolderColor:"rgb(111, 111, 111)",type:"text",disabled:!1,disabledColor:"rgb(247, 247, 247)",disabledFontColor:"#545454",disabledBorderColor:"rgb(204, 204, 204)",passwordChar:"●",bounds:{x:0,y:0,w:100},padding:{top:1,left:1,right:1,bottom:2},border:{top:1,left:1,right:1,bottom:1},focusBorder:{top:3,left:3,right:3,bottom:3},enterCallback:t=>{},hoverCallback:t=>{},focusCallback:t=>{}});let I=E;function lt(){const v=document.getElementById("myCanvas"),t=v.getContext("2d"),e=document.getElementById("show"),i=document.getElementById("enable"),n=[new I({bounds:{x:10,y:20,w:300},maxLength:8},v),new I({fontSize:30,bounds:{x:10,y:50,w:300},placeHolder:"한글을 입력해주세요"},v),new I({bounds:{x:10,y:110,w:300},type:"number",placeHolder:"숫자",maxLength:8},v),new I({bounds:{x:10,y:150,w:300},type:"password",placeHolder:"암호",maxLength:15},v),new I({bounds:{x:10,y:180,w:300},disabled:!0},v)];e.addEventListener("click",()=>{const c=n[n.length-2];c.type==="password"?(c.type="text",e.textContent="Hide"):(c.type="password",e.textContent="Show")}),i.addEventListener("click",()=>{const c=n[n.length-1];c.disabled?(c.disabled=!1,i.textContent="Enable"):(c.disabled=!0,i.textContent="Disable")}),document.addEventListener("keydown",c=>{const m=c.key,d=c.shiftKey;if(m==="Tab"&&!d){a();return}m==="Tab"&&d&&M()});const o=document.getElementById("show2"),h=document.getElementById("enable2");o.addEventListener("click",()=>{const c=document.getElementById("password");c.type==="password"?(c.type="text",o.textContent="Hide"):(c.type="password",o.textContent="Show")}),h.addEventListener("click",()=>{const c=document.getElementById("disabled");c.disabled?(c.disabled=!1,h.textContent="Enable"):(c.disabled=!0,h.textContent="Disable")});function a(){const c=n.findIndex(T=>T.focus),m=c===-1?0:c;let d=(m+1)%n.length;for(;n[d].disabled&&(d=(d+1)%n.length,d!==m););n[m].focus=!1,n[d].focus=!0,n[d].selectAllText()}function M(){const c=n.findIndex(T=>T.focus),m=c===-1?0:c;let d=(m-1+n.length)%n.length;for(;n[d].disabled&&(d=(d-1+n.length)%n.length,d!==m););n[m].focus=!1,n[d].focus=!0,n[d].selectAllText()}let B=0;function R(c){const m=(c-B)/1e3;t.clearRect(0,0,v.width,v.height),n.forEach(d=>d.update(m)),n.forEach(d=>d.draw()),n.forEach(d=>{const{x:T,y:k,w:j}=d.area(),K=d.getMaxLength();if(K===-1)return;t.font="12px Monospaced",t.textAlign="left",t.textBaseline="middle",t.fillStyle="gray";const G=`${K-d.getLength()} remain`,W=t.measureText(G).width;t.fillText(G,T+j-W-8,k-7)}),B=c,window.requestAnimationFrame(R)}requestAnimationFrame(R)}document.addEventListener("DOMContentLoaded",lt);

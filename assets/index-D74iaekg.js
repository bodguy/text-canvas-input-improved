var ot=Object.defineProperty;var rt=(v,t,e)=>t in v?ot(v,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):v[t]=e;var S=(v,t,e)=>rt(v,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();var $={exports:{}},Z;function ht(){return Z||(Z=1,function(v){(function(){var t=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],e=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ",["ㅗ","ㅏ"],["ㅗ","ㅐ"],["ㅗ","ㅣ"],"ㅛ","ㅜ",["ㅜ","ㅓ"],["ㅜ","ㅔ"],["ㅜ","ㅣ"],"ㅠ","ㅡ",["ㅡ","ㅣ"],"ㅣ"],s=["","ㄱ","ㄲ",["ㄱ","ㅅ"],"ㄴ",["ㄴ","ㅈ"],["ㄴ","ㅎ"],"ㄷ","ㄹ",["ㄹ","ㄱ"],["ㄹ","ㅁ"],["ㄹ","ㅂ"],["ㄹ","ㅅ"],["ㄹ","ㅌ"],["ㄹ","ㅍ"],["ㄹ","ㅎ"],"ㅁ","ㅂ",["ㅂ","ㅅ"],"ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],n=44032,r=["ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄸ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅃ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],f=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],y=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"],O=["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],B=[["ㄱ","ㅅ","ㄳ"],["ㄴ","ㅈ","ㄵ"],["ㄴ","ㅎ","ㄶ"],["ㄹ","ㄱ","ㄺ"],["ㄹ","ㅁ","ㄻ"],["ㄹ","ㅂ","ㄼ"],["ㄹ","ㅅ","ㄽ"],["ㄹ","ㅌ","ㄾ"],["ㄹ","ㅍ","ㄿ"],["ㄹ","ㅎ","ㅀ"],["ㅂ","ㅅ","ㅄ"]],D=[["ㅗ","ㅏ","ㅘ"],["ㅗ","ㅐ","ㅙ"],["ㅗ","ㅣ","ㅚ"],["ㅜ","ㅓ","ㅝ"],["ㅜ","ㅔ","ㅞ"],["ㅜ","ㅣ","ㅟ"],["ㅡ","ㅣ","ㅢ"]],h,x,a,P,I,W;function K(i){for(var o=i.length,p={0:0},l=0;l<o;l++)i[l]&&(p[i[l].charCodeAt(0)]=l);return p}h=K(r),x=K(f),a=K(y),P=K(O);function G(i){for(var o=i.length,p={},l,c,d=0;d<o;d++)l=i[d][0].charCodeAt(0),c=i[d][1].charCodeAt(0),typeof p[l]>"u"&&(p[l]={}),p[l][c]=i[d][2].charCodeAt(0);return p}I=G(B),W=G(D);function _(i){return typeof h[i]<"u"}function E(i){return typeof x[i]<"u"}function T(i){return typeof a[i]<"u"}function U(i){return typeof P[i]<"u"}function j(i){return 44032<=i&&i<=55203}function X(i,o){return W[i]&&W[i][o]?W[i][o]:!1}function z(i,o){return I[i]&&I[i][o]?I[i][o]:!1}var M=function(i,o){if(i===null)throw new Error("Arguments cannot be null");typeof i=="object"&&(i=i.join(""));for(var p=[],l=i.length,c,d,L,C,g,m=0;m<l;m++){var u=[];C=i.charCodeAt(m),j(C)?(C-=n,L=C%28,d=(C-L)/28%21,c=parseInt((C-L)/28/21),u.push(t[c]),typeof e[d]=="object"?u=u.concat(e[d]):u.push(e[d]),L>0&&(typeof s[L]=="object"?u=u.concat(s[L]):u.push(s[L]))):_(C)?(E(C)?g=t[x[C]]:g=s[P[C]],typeof g=="string"?u.push(g):u=u.concat(g)):T(C)?(g=e[a[C]],typeof g=="string"?u.push(g):u=u.concat(g)):u.push(i.charAt(m)),o?p.push(u):p=p.concat(u)}return p},q=function(i){return typeof i!="string"?"":(i=M(i),i.join(""))},Y=function(i){typeof i=="string"&&(i=M(i));var o=[],p=i.length,l,c=0,d=-1,L,C=!1;function g(u){var b,w,V,R=0,J,N="";if(C=!1,!(d+1>u))for(var A=1;;A++){if(A===1){if(b=i[d+A].charCodeAt(0),T(b))if(d+A+1<=u&&T(w=i[d+A+1].charCodeAt(0))){o.push(String.fromCharCode(X(b,w))),d=u;return}else{o.push(i[d+A]),d=u;return}else if(!E(b)){o.push(i[d+A]),d=u;return}N=i[d+A]}else if(A===2)if(w=i[d+A].charCodeAt(0),E(w)){b=z(b,w),N=String.fromCharCode(b),o.push(N),d=u;return}else N=String.fromCharCode((x[b]*21+a[w])*28+n);else A===3?(V=i[d+A].charCodeAt(0),X(w,V)?w=X(w,V):R=V,N=String.fromCharCode((x[b]*21+a[w])*28+P[R]+n)):A===4?(J=i[d+A].charCodeAt(0),z(R,J)?R=z(R,J):R=J,N=String.fromCharCode((x[b]*21+a[w])*28+P[R]+n)):A===5&&(J=i[d+A].charCodeAt(0),R=z(R,J),N=String.fromCharCode((x[b]*21+a[w])*28+P[R]+n));if(d+A>=u){o.push(N),d=u;return}}}for(var m=0;m<p;m++){if(l=i[m].charCodeAt(0),!E(l)&&!T(l)&&!U(l)){g(m-1),g(m),c=0;continue}c===0?E(l)?c=1:T(l)&&(c=4):c==1?T(l)?c=2:z(L,l)?c=5:g(m-1):c==2?U(l)?c=3:T(l)?X(L,l)||(g(m-1),c=4):(g(m-1),c=1):c==3?U(l)?!C&&z(L,l)?C=!0:(g(m-1),c=1):E(l)?(g(m-1),c=1):T(l)&&(g(m-2),c=2):c==4?T(l)?X(L,l)?(g(m),c=0):g(m-1):(g(m-1),c=1):c==5&&(T(l)?(g(m-2),c=2):(g(m-1),c=1)),L=l}return g(m-1),o.join("")},tt=function(i,o){var p=M(i).join(""),l=M(o).join("");return p.indexOf(l)},et=function(i,o){var p=M(i).join(""),l=M(o).join(""),c=M(i,!0),d=new RegExp(l,"gi"),L=[],C;if(!o.length)return[];for(;C=d.exec(p);)L.push(C.index);function g(u){for(var b=0,w=0;b<c.length;++b)if(w+=c[b].length,u<w)return b}function m(u){for(var b=0,w=0;b<c.length;++b)if(w+=c[b].length,u+l.length<=w)return b}return L.map(function(u){return[g(u),m(u)]})};function Q(i){this.string=i,this.disassembled=M(i).join("")}Q.prototype.search=function(i){return M(i).join("").indexOf(this.disassembled)};var st=function(i){typeof i=="object"&&(i=i.join(""));var o=i.charCodeAt(i.length-1);if(j(o)){o-=n;var p=o%28;if(p>0)return!0}else if(_(o))return!0;return!1},it=function(i,o){return M(i).pop()===o},nt={disassemble:M,d:M,disassembleToString:q,ds:q,assemble:Y,a:Y,search:tt,rangeSearch:et,Searcher:Q,endsWithConsonant:st,endsWith:it,isHangul:function(i){return typeof i=="string"&&(i=i.charCodeAt(0)),j(i)},isComplete:function(i){return typeof i=="string"&&(i=i.charCodeAt(0)),j(i)},isConsonant:function(i){return typeof i=="string"&&(i=i.charCodeAt(0)),_(i)},isVowel:function(i){return typeof i=="string"&&(i=i.charCodeAt(0)),T(i)},isCho:function(i){return typeof i=="string"&&(i=i.charCodeAt(0)),E(i)},isJong:function(i){return typeof i=="string"&&(i=i.charCodeAt(0)),U(i)},isHangulAll:function(i){if(typeof i!="string")return!1;for(var o=0;o<i.length;o++)if(!j(i.charCodeAt(o)))return!1;return!0},isCompleteAll:function(i){if(typeof i!="string")return!1;for(var o=0;o<i.length;o++)if(!j(i.charCodeAt(o)))return!1;return!0},isConsonantAll:function(i){if(typeof i!="string")return!1;for(var o=0;o<i.length;o++)if(!_(i.charCodeAt(o)))return!1;return!0},isVowelAll:function(i){if(typeof i!="string")return!1;for(var o=0;o<i.length;o++)if(!T(i.charCodeAt(o)))return!1;return!0},isChoAll:function(i){if(typeof i!="string")return!1;for(var o=0;o<i.length;o++)if(!E(i.charCodeAt(o)))return!1;return!0},isJongAll:function(i){if(typeof i!="string")return!1;for(var o=0;o<i.length;o++)if(!U(i.charCodeAt(o)))return!1;return!0}};v.exports=nt})()}($)),$.exports}var k=ht();class lt{constructor(t=50){S(this,"maxSize");S(this,"undoStack");S(this,"redoStack");S(this,"lastSavedState");this.maxSize=t,this.undoStack=[],this.redoStack=[],this.lastSavedState=null}saveState(t,e){if(!(t===""||this.lastSavedState===t)){if(e&&this.lastSavedState){const s=this.undoStack.pop()??"";this.undoStack.push(s+t)}else this.undoStack.push(t);this.undoStack.length>this.maxSize&&this.undoStack.shift(),this.redoStack=[],this.lastSavedState=t}}undo(){if(this.undoStack.length===0)return null;const t=this.undoStack.pop();return t?(this.redoStack.push(t),this.undoStack.length>0?this.undoStack[this.undoStack.length-1]:""):null}redo(){if(this.redoStack.length===0)return null;const t=this.redoStack.pop();return t?(this.undoStack.push(t),t):null}}const H=class H{constructor(t,e){S(this,"canvas");S(this,"context");S(this,"value");S(this,"selection");S(this,"isFocused");S(this,"selectionPos");S(this,"blinkTimer");S(this,"maxLength");S(this,"assemblePos");S(this,"wasOver");S(this,"settings");S(this,"hangulMode");S(this,"undoManager");this.canvas=e,this.context=e.getContext("2d"),this.settings=Object.assign({},H.defaultSettings,t),this.value=this.settings.defaultValue,this.selection=[0,0],this.isFocused=!1,this.blinkTimer=0,this.maxLength=this.settings.maxLength,this.resetSelectionPos(),this.resetAssembleMode(),this.wasOver=!1,this.hangulMode=!1,this.undoManager=new lt,document.addEventListener("keydown",this.onKeyDown.bind(this)),this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this),!0),this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this),!0),document.addEventListener("mouseup",this.onMouseUp.bind(this),!0),this.canvas.addEventListener("dblclick",this.onDoubleClick.bind(this),!0),document.addEventListener("copy",s=>this.onCopy.call(this,s)),document.addEventListener("paste",s=>this.onPaste.call(this,s)),document.addEventListener("cut",s=>this.onCut.call(this,s))}draw(){this.context.font=`${this.settings.fontSize}px ${this.settings.font}`,this.context.textAlign="left",this.context.textBaseline="middle";const t=this.getStartX(),e=this.getStartY(),s=this.area(),n=Math.round(e+Math.round(this.settings.fontSize/2)+1);if(this.context.save(),this.context.beginPath(),this.context.rect(s.x,s.y,s.w+1,s.h+1),this.context.clip(),this.disabled&&(this.context.fillStyle=this.settings.disabledColor,this.context.fillRect(this.settings.bounds.x-this.settings.padding.left,this.settings.bounds.y-this.settings.padding.top,s.w,s.h)),this.isFocused){if(this.isSelected()){const h=this.measureText(this.getSubText(0,Math.min(this.selection[0],this.selection[1]))),x=this.measureText(this.getSelectionText());this.context.fillStyle=this.settings.selectionColor,this.context.fillRect(h+t,e-1,x,this.settings.fontSize+3)}else if(this.cursorBlink()){const h=this.measureText(this.getSubText(0,this.selection[0]));this.context.fillStyle=this.settings.fontColor,this.context.fillRect(h+t,e,1,this.settings.fontSize)}}const[r,f]=this.getSelectionOutside(),y=this.getSelectionText(),O=this.getDrawText(r),B=this.getDrawText(y),D=this.getDrawText(f);this.context.fillStyle=this.disabled?this.settings.disabledFontColor:this.settings.fontColor,this.context.fillText(O,t,n),this.context.fillStyle=this.disabled?this.settings.disabledFontColor:this.settings.selectionFontColor,this.context.fillText(B,t+this.measureText(r),n),this.context.fillStyle=this.disabled?this.settings.disabledFontColor:this.settings.fontColor,this.context.fillText(D,t+this.measureText(r+y),n),this.isEmpty()&&(this.context.fillStyle=this.settings.placeHolderColor,this.context.fillText(this.settings.placeHolder,t,n)),this.isFocused&&this.isAssembleMode()&&this.drawUnderline(),this.drawRect(s.x,s.y,s.w,s.h),this.context.restore()}update(t){this.blinkTimer+=t}isSelected(){return this.selection[0]!==this.selection[1]}isEmpty(){return this.getLength()===0}getLength(){return this.value.length}getMaxLength(){return this.settings.maxLength}set text(t){this.value="",this.onSetText(t)}get text(){return this.value}get focus(){return this.isFocused}set focus(t){t&&!this.disabled?(this.isFocused=!0,this.blinkTimer=this.settings.caretBlinkRate,this.settings.focusCallback(!0)):(this.onStartOfSelection(),this.resetAssembleMode(),this.resetSelectionPos(),this.isFocused=!1,this.settings.focusCallback(!1))}get disabled(){return this.settings.disabled}set disabled(t){this.settings.disabled=t,this.focus=!1}get type(){return this.settings.type}set type(t){this.settings.type=t,this.resetAssembleMode(),this.onCancelOfSelectionEnd()}moveSelection(t){this.setSelection(t,t)}setSelection(t,e){t=this.clamp(t,0,this.getLength()),e=this.clamp(e,0,this.getLength()),this.selection[0]=t,this.selection[1]=e,this.blinkTimer=this.settings.caretBlinkRate}at(t){return this.value[t]}getDrawText(t){return this.isPassword()?this.settings.passwordChar.repeat(t.length):t}drawUnderline(){const t=this.getStartX(),e=this.getStartY()+this.settings.fontSize-2;this.context.fillStyle=this.settings.underlineColor;const s=this.measureText(this.getAssemblePosBefore()),n=this.measureText(this.getAssemblePosChar());this.context.fillRect(s+t,e,n,2)}getStartX(){return this.settings.bounds.x+this.settings.padding.left+this.settings.border.left}getStartY(){return this.settings.bounds.y+this.settings.padding.top+this.settings.border.top}measureText(t){return this.context.font=`${this.settings.fontSize}px ${this.settings.font}`,this.context.textAlign="left",this.context.textBaseline="middle",this.context.measureText(this.getDrawText(t)).width}cursorBlink(){return Math.floor(this.blinkTimer/this.settings.caretBlinkRate)%2}getSelectionText(){return this.getSubText(this.selection[0],this.selection[1])}getSelection(){return this.selection}getSubText(t,e){return this.value.substring(t,e)}extendSelection(t,e){this.setSelection(t,e)}moveRightBoundary(){const t=Math.max(this.selection[0],this.selection[1]);this.moveSelection(t)}moveLeftBoundary(){const t=Math.min(this.selection[0],this.selection[1]);this.moveSelection(t)}extendRightBoundary(){const t=Math.min(this.selection[0],this.selection[1]);this.extendSelection(t,this.getLength())}extendLeftBoundary(){const t=Math.max(this.selection[0],this.selection[1]);this.extendSelection(t,0)}onRight(t){t.preventDefault();const e=t.altKey||t.ctrlKey,s=t.shiftKey,n=t.metaKey;if(this.resetAssembleMode(),this.isSelected()){s?n?this.extendRightBoundary():e?this.extendSelection(this.selection[0],this.getNextStopPosition(!1,this.isPassword())):this.extendSelection(this.selection[0],this.selection[1]+1):n?this.onEndOfSelection():this.moveRightBoundary();return}if(e){const r=this.isPassword()?this.getLength():this.getStopWordRange(this.selection[1])[1];s?this.extendSelection(this.selection[0],r):this.moveSelection(r);return}if(n){s?this.extendSelection(this.selection[0],this.getLength()):this.onEndOfSelection();return}s?this.extendSelection(this.selection[0],this.selection[1]+1):this.moveSelection(this.selection[1]+1)}onLeft(t){t.preventDefault();const e=t.altKey||t.ctrlKey,s=t.shiftKey,n=t.metaKey;if(this.resetAssembleMode(),this.isSelected()){s?n?this.extendLeftBoundary():e?this.extendSelection(this.selection[0],this.getNextStopPosition(!0,this.isPassword())):this.extendSelection(this.selection[0],this.selection[1]-1):n?this.onStartOfSelection():this.moveLeftBoundary();return}if(e){const r=this.isPassword()?0:this.getStopWordRange(this.selection[0]-1)[0];s?this.extendSelection(this.selection[1],r):this.moveSelection(r);return}if(n){s?this.extendSelection(this.selection[1],0):this.onStartOfSelection();return}s?this.extendSelection(this.selection[0],this.selection[1]-1):this.moveSelection(this.selection[1]-1)}getNextStopPosition(t,e){if(e)return t?0:this.getLength();const s=t?this.getStopWordRange(this.selection[1]-1)[0]:this.getStopWordRange(this.selection[1])[1];return t&&this.isRightDirection()&&s<this.selection[0]||!t&&this.isLeftDirection()&&s>this.selection[0]?this.selection[0]:s}isRightDirection(){return this.selection[0]<this.selection[1]}isLeftDirection(){return this.selection[0]>this.selection[1]}onHome(t){if(t.preventDefault(),t.shiftKey){const s=Math.max(this.selection[0],this.selection[1]);this.extendSelection(s,0)}else this.onStartOfSelection()}onEnd(t){if(t.preventDefault(),t.shiftKey){const s=Math.min(this.selection[0],this.selection[1]);this.extendSelection(s,this.getLength())}else this.onEndOfSelection()}onStartOfSelection(){this.moveSelection(0)}onEndOfSelection(){this.moveSelection(this.getLength())}onCancelOfSelectionStart(){this.moveSelection(this.selection[0])}onCancelOfSelectionEnd(){this.moveSelection(this.selection[1])}handleMetaInput(t){const e=t.key,s=t.metaKey||t.ctrlKey,n=t.shiftKey;return s&&(e==="c"||e==="C"||e==="ㅊ")||s&&(e==="v"||e==="V"||e==="ㅍ")||s&&(e==="x"||e==="X"||e==="ㅌ")?!0:s&&(e==="a"||e==="A"||e==="ㅁ")?(t.preventDefault(),this.selectAllText(),!0):s&&(e==="r"||e==="R"||e==="ㄱ")?!0:s&&n&&(e==="z"||e==="ㅋ")?(t.preventDefault(),this.handleRedo(),!0):s&&(e==="z"||e==="ㅋ")?(t.preventDefault(),this.handleUndo(),!0):s}handleTypedText(t){const e=t.key;this.handleMetaInput(t)||e.length>1||this.appendValue(e)}isMaxLengthOverflow(t=""){return this.maxLength===-1?!1:this.getLength()+t.length>this.maxLength}isNumeric(t){return/^-?\d+$/.test(t)}handleMaxLengthOverflow(t){const[e,s]=this.getSelectionOutside(),n=this.settings.maxLength-(e.length+s.length),r=t.substring(0,n);r.length>0&&this.handleNonHangul(e,r,s)}appendValue(t){if(this.type==="number"&&!this.isNumeric(t))return;if(this.isMaxLengthOverflow(t)){this.handleMaxLengthOverflow(t);return}const e=this.hangulMode?this.convertEnglishToKorean(t):t,[s,n]=this.getSelectionOutside();this.isHangul(e)?this.handleHangul(s,e,n):this.handleNonHangul(s,e,n)}handleHangul(t,e,s){if(this.isPassword()){this.assembleHangul(t,this.convertKoreanToEnglish(e),s);return}this.isAssembleMode()?this.assembleHangul(this.getAssemblePosBefore(),k.a(k.d(this.getAssemblePosChar()+e)),s):this.assembleHangul(t,k.a(k.d(e)),s)}assembleHangul(t,e,s){this.value=t+e+s;const n=t.length+e.length;this.moveSelection(n),this.setAssemblePos(n-1)}handleNonHangul(t,e,s){const n=t.length+e.length;this.value=t+e+s,this.moveSelection(n),this.resetAssembleMode()}onRemoveBackward(t){t.preventDefault();const e=t.altKey||t.ctrlKey;if(this.isSelected()){const[f,y]=this.getSelectionOutside();this.value=f+y,this.moveSelection(f.length);return}this.isAssembleMode()&&this.resetAssembleMode();const[s,n]=this.getSelectionOutside(),r=n.slice(this.getSlicePosition(n,!1,e,!1));this.value=s+r,this.moveSelection(s.length)}onRemoveForward(t){t.preventDefault();const e=t.metaKey,s=t.altKey||t.ctrlKey;if(this.isSelected()){const[y,O]=this.getSelectionOutside();this.value=y+O,this.moveSelection(y.length);return}if(this.isAssembleMode()&&!e){const y=this.getAssemblePosBefore(),O=k.d(this.getAssemblePosChar()),B=this.getAssemblePosAfter(),D=k.a(O.slice(0,-1));D===""&&this.resetAssembleMode();const h=y+D;this.value=h+B,this.moveSelection(h.length);return}const[n,r]=this.getSelectionOutside(),f=n.slice(0,this.getSlicePosition(n,!0,s,e));this.value=f+r,this.moveSelection(f.length)}getSlicePosition(t,e,s,n){return e?n?-t.length:s?this.isPassword()?-t.length:this.getStopWordRange(this.selection[1]-1)[0]:-1:s?this.isPassword()?t.length:this.getStopWordRange(this.selection[1])[1]:1}setAssemblePos(t){this.assemblePos=t}resetAssembleMode(){this.assemblePos=-1}isAssembleMode(){return this.assemblePos!==-1}isHangul(t){const e=t.charCodeAt(0);return e>=4352&&e<=4607||e>=12592&&e<=12687||e>=44032&&e<=55203}isSelectionStart(){return this.selectionPos>=0}resetSelectionPos(){this.selectionPos=-1}textPos(t,e){const s=t-this.area().x;let n=0,r=this.getLength();if(s<this.measureText(this.value)){for(let f=0;f<this.getLength();f++)if(n+=this.measureText(this.at(f)),n>=s){r=f;break}}return r}getMousePos(t){const s=t.target.getBoundingClientRect(),n=t.clientX-s.left,r=t.clientY-s.top;return{x:n,y:r}}isPassword(){return this.type==="password"}onKeyDown(t){if(!this.isFocused)return;switch(t.key){case"Meta":case"Alt":case"Shift":case"Control":case"Tab":case"ArrowUp":case"ArrowDown":t.preventDefault();break;case"Enter":this.settings.enterCallback(t);break;case"Backspace":this.onRemoveForward(t);break;case"Delete":this.onRemoveBackward(t);break;case"ArrowRight":this.onRight(t);break;case"ArrowLeft":this.onLeft(t);break;case"Escape":this.onCancelOfSelectionEnd();break;case"Home":this.onHome(t);break;case"End":this.onEnd(t);break;case"HangulMode":this.hangulMode=!this.hangulMode;break;case" ":t.preventDefault();default:this.handleTypedText(t);break}}onMouseMove(t){const e=this.getMousePos(t);if(this.contains(e.x,e.y)&&!this.disabled?(this.settings.hoverCallback(!0),this.canvas.style.cursor="text",this.wasOver=!0):(this.settings.hoverCallback(!1),this.wasOver&&(this.canvas.style.cursor="default",this.wasOver=!1)),!this.isFocused||!this.isSelectionStart())return;const s=this.textPos(e.x,e.y),n=Math.min(this.selectionPos,s),r=Math.max(this.selectionPos,s);this.extendSelection(n,r)}onMouseDown(t){t.preventDefault();const e=t.button===0,s=this.getMousePos(t);if(this.resetAssembleMode(),e&&this.contains(s.x,s.y)&&!this.disabled){this.focus=!0;const n=this.textPos(s.x,s.y);if(t.detail===3&&n>=this.selection[0]&&n<=this.selection[1]){this.selectAllText();return}this.moveSelection(n),this.selectionPos=n;return}this.focus=!1}onMouseUp(t){this.isFocused&&this.resetSelectionPos()}onDoubleClick(t){if(!this.isFocused)return;t.preventDefault();const e=t.button===0,s=this.getMousePos(t);if(e&&this.contains(s.x,s.y))if(this.isPassword())this.selectAllText();else{const n=this.textPos(s.x,s.y),[r,f]=this.getStopWordRange(n);this.extendSelection(r,f)}}onCopy(t){!this.isFocused||this.isPassword()||this.isEmpty()||(t.clipboardData.setData("text/plain",this.getSelectionText()),t.preventDefault())}onPaste(t){this.isFocused&&(this.onSetText(t.clipboardData.getData("text/plain")),t.preventDefault())}onCut(t){if(!this.isFocused||this.isPassword()||this.isEmpty())return;t.clipboardData.setData("text/plain",this.getSelectionText()),t.preventDefault();const[e,s]=this.getSelectionOutside();this.value=e+s,this.moveSelection(e.length)}onSetText(t){if(this.type==="number"&&!this.isNumeric(t))return;if(this.isMaxLengthOverflow(t)){this.handleMaxLengthOverflow(t);return}const[e,s]=this.getSelectionOutside();this.handleNonHangul(e,t,s)}expandDelimiterRange(t){const e=this.at(t);let s=t,n=t;for(;s>0&&this.isDelimiter(this.at(s-1))&&this.at(s-1)===e;)s--;for(;n<this.getLength()&&this.isDelimiter(this.at(n))&&this.at(n)===e;)n++;return[s,n]}expandSpaceRange(t){let e=t,s=t;for(;e>0&&this.at(e-1)===" ";)e--;for(;s<this.getLength()&&this.at(s)===" ";)s++;return e=this.expandRemainRange(e-1)[0],s=this.expandRemainRange(s)[1],[e,s]}expandNotCompleteHangulRange(t){let e=t,s=t+1;for(;e>0&&this.isNotCompleteHangul(this.at(e-1));)e--;for(;s<this.getLength()&&this.isNotCompleteHangul(this.at(s));)s++;return[e,s]}expandWordRange(t){const e=this.at(t);let s=0,n=this.getLength();const r=this.isHangul(e);for(let f=1;f<this.getLength();f++){const y=t-f,O=t+f;if(y>=0&&s===0&&this.isStopWord(y,r)&&(s=y+1),O<this.getLength()&&n===this.getLength()&&this.isStopWord(O,r)&&(n=O),s!==0&&n!==this.getLength())break}return[s,n]}getStopWordRange(t){const e=this.at(t);return e?e===" "?this.expandSpaceRange(t):this.expandRemainRange(t):[t,t]}expandRemainRange(t){const e=this.at(t);return e?this.isDelimiter(e)?this.expandDelimiterRange(t):this.isNotCompleteHangul(e)?this.expandNotCompleteHangulRange(t):this.expandWordRange(t):[t,t]}isStopWord(t,e){const s=this.at(t);return this.isDelimiter(s)||e&&(!this.isHangul(s)||this.isNotCompleteHangul(s))||!e&&this.isHangul(s)}isNotCompleteHangul(t){return this.isHangul(t)&&!k.isComplete(t)}isDelimiter(t){return H.DELIMITERS.has(t)}selectAllText(){this.extendSelection(0,this.getLength()),this.resetAssembleMode()}handleRedo(){const t=this.undoManager.redo();t!==null&&(this.text=t,this.onEndOfSelection(),this.resetAssembleMode())}handleUndo(){const t=this.undoManager.undo();t!==null&&(this.text=t,this.onEndOfSelection(),this.resetAssembleMode())}getSelectionOutside(){const t=Math.min(this.selection[0],this.selection[1]),e=Math.max(this.selection[0],this.selection[1]),s=this.getSubText(0,t),n=this.getSubText(e,this.getLength());return[s,n]}getAssemblePosBefore(){return this.getSubText(0,this.assemblePos)}getAssemblePosChar(){return this.getSubText(this.assemblePos,Math.min(this.assemblePos+1,this.getLength()))}getAssemblePosAfter(){return this.getSubText(Math.min(this.assemblePos+1,this.getLength()),this.getLength())}area(){return{x:this.settings.bounds.x-this.settings.padding.left-this.settings.border.left,y:this.settings.bounds.y-this.settings.padding.top-this.settings.border.top,w:this.settings.bounds.w+this.settings.padding.right+this.settings.border.right,h:this.settings.fontSize+4+this.settings.padding.bottom+this.settings.border.bottom}}contains(t,e){const s=this.area();return t>=s.x&&t<=this.settings.bounds.x+s.w&&e>=s.y&&e<=this.settings.bounds.y+s.h}drawRect(t,e,s,n){this.context.beginPath();const r=1;this.context.strokeStyle=this.isFocused?this.settings.focusBoxColor:this.disabled?this.settings.disabledBorderColor:this.settings.boxColor,this.context.lineWidth=this.isFocused?this.settings.focusBorder.left:this.settings.border.left,this.context.moveTo(t+.5,e+r),this.context.lineTo(t+.5,e+n),this.context.lineWidth=this.isFocused?this.settings.focusBorder.right:this.settings.border.right,this.context.moveTo(t+s+.5,e+r),this.context.lineTo(t+s+.5,e+n),this.context.lineWidth=this.isFocused?this.settings.focusBorder.top:this.settings.border.top,this.context.moveTo(t+r,e+.5),this.context.lineTo(t+s,e+.5),this.context.lineWidth=this.isFocused?this.settings.focusBorder.bottom:this.settings.border.bottom,this.context.moveTo(t+r,e+n+.5),this.context.lineTo(t+s,e+n+.5),this.context.stroke()}clamp(t,e,s){return Math.min(Math.max(t,e),s)}convertKoreanToEnglish(t){return H.KOREAN_TO_ENGLISH[t]??t}convertEnglishToKorean(t){return H.ENGLISH_TO_KOREAN[t]??t}};S(H,"DELIMITERS",new Set([" ",",",".",";",":","/","[","]","-","\\","?","#","$","%","^","&","*","(",")","!","@","+","=","|","~","`","{","}",'"',"'","<",">"])),S(H,"KOREAN_TO_ENGLISH",{ㅁ:"a",ㄴ:"s",ㅇ:"d",ㄹ:"f",ㅎ:"g",ㅗ:"h",ㅓ:"j",ㅏ:"k",ㅣ:"l",ㅂ:"q",ㅈ:"w",ㄷ:"e",ㄱ:"r",ㅅ:"t",ㅛ:"y",ㅕ:"u",ㅑ:"i",ㅐ:"o",ㅔ:"p",ㅋ:"z",ㅌ:"x",ㅊ:"c",ㅍ:"v",ㅠ:"b",ㅜ:"n",ㅡ:"m",ㅃ:"Q",ㅉ:"W",ㄸ:"E",ㄲ:"R",ㅆ:"T",o:"ㅒ",p:"ㅖ"}),S(H,"ENGLISH_TO_KOREAN",Object.fromEntries(Object.entries(H.KOREAN_TO_ENGLISH).map(([t,e])=>[e,t]))),S(H,"defaultSettings",{font:"Apple SD Gothic Neo",fontColor:"#000",selectionFontColor:"#FFF",selectionColor:"#0D0577",boxColor:"#767676",focusBoxColor:"#000",underlineColor:"#000",fontSize:13,maxLength:-1,caretBlinkRate:.5,defaultValue:"",placeHolder:"",placeHolderColor:"rgb(111, 111, 111)",type:"text",disabled:!1,disabledColor:"rgb(247, 247, 247)",disabledFontColor:"#545454",disabledBorderColor:"rgb(204, 204, 204)",passwordChar:"●",bounds:{x:0,y:0,w:100},padding:{top:1,left:1,right:1,bottom:2},border:{top:1,left:1,right:1,bottom:1},focusBorder:{top:3,left:3,right:3,bottom:3},enterCallback:t=>{},hoverCallback:t=>{},focusCallback:t=>{}});let F=H;function at(){const v=document.getElementById("myCanvas"),t=v.getContext("2d"),e=document.getElementById("show"),s=document.getElementById("enable"),n=[new F({bounds:{x:10,y:20,w:300},maxLength:8},v),new F({fontSize:30,bounds:{x:10,y:50,w:300},placeHolder:"한글을 입력해주세요"},v),new F({bounds:{x:10,y:110,w:300},type:"number",placeHolder:"숫자",maxLength:8},v),new F({bounds:{x:10,y:150,w:300},type:"password",placeHolder:"암호",maxLength:15},v),new F({bounds:{x:10,y:180,w:300},disabled:!0},v)];e.addEventListener("click",()=>{const h=n[n.length-2];h.type==="password"?(h.type="text",e.textContent="Hide"):(h.type="password",e.textContent="Show")}),s.addEventListener("click",()=>{const h=n[n.length-1];h.disabled?(h.disabled=!1,s.textContent="Enable"):(h.disabled=!0,s.textContent="Disable")}),document.addEventListener("keydown",h=>{const x=h.key,a=h.shiftKey;if(x==="Tab"&&!a){y();return}x==="Tab"&&a&&O()});const r=document.getElementById("show2"),f=document.getElementById("enable2");r.addEventListener("click",()=>{const h=document.getElementById("password");h.type==="password"?(h.type="text",r.textContent="Hide"):(h.type="password",r.textContent="Show")}),f.addEventListener("click",()=>{const h=document.getElementById("disabled");h.disabled?(h.disabled=!1,f.textContent="Enable"):(h.disabled=!0,f.textContent="Disable")});function y(){const h=n.findIndex(P=>P.focus),x=h===-1?0:h;let a=(x+1)%n.length;for(;n[a].disabled&&(a=(a+1)%n.length,a!==x););n[x].focus=!1,n[a].focus=!0,n[a].selectAllText()}function O(){const h=n.findIndex(P=>P.focus),x=h===-1?0:h;let a=(x-1+n.length)%n.length;for(;n[a].disabled&&(a=(a-1+n.length)%n.length,a!==x););n[x].focus=!1,n[a].focus=!0,n[a].selectAllText()}let B=0;function D(h){const x=(h-B)/1e3;t.clearRect(0,0,v.width,v.height),n.forEach(a=>a.update(x)),n.forEach(a=>a.draw()),n.forEach(a=>{const{x:P,y:I,w:W}=a.area(),K=a.getMaxLength();if(K===-1)return;t.font="12px Monospaced",t.textAlign="left",t.textBaseline="middle",t.fillStyle="gray";const G=`${K-a.getLength()} remain`,_=t.measureText(G).width;t.fillText(G,P+W-_-8,I-7)}),B=h,window.requestAnimationFrame(D)}requestAnimationFrame(D)}document.addEventListener("DOMContentLoaded",at);
